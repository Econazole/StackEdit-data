
```
mingwei.yan(严明伟)
http://sswiki:8090/pages/viewpage.action?pageId=37965994
```

用户空间3gb和内核空间1gb组成了4GB的虚拟内存
每个进程都被分配了4GB的虚拟内存，其中：
- 0~3GB：用户空间，每个进程私有，其他进程不可见
- 3~4GB：内核空间，由系统中的所有进程共享

什么是CPU上下文

为什么线程上下文切换比进程快？
同一进程下的线程共享虚拟内存，切换时消耗更少的资源

零拷贝？传统IO？DMA拷贝？


---
```
Mico.sun
http://sswiki:8090/pages/viewpage.action?pageId=37960512
```

虚拟内存概述

基于程序的局限性原理，在计算机中运行的程序，其代码、数据、堆和栈的总量可以超过实际内存的大小，操作系统只将当前使用的程序块保存在内存中，其余的程序块则保留在磁盘上。必要时，操作系统负责在磁盘和内存之间交换程序块。
进程虚拟地址空间，多个进程可以同时运行又不会相互干扰，有如下说明：

- **说明1：从进程角度，每个进程拥有4GB虚拟地址空间**
	32位体系结构中提供4GB的进程虚拟地址空间，其中：
	- 0~3GB：用户空间，每个进程私有，其他进程不可见
	- 3~4GB：内核空间，由系统中的所有进程共享

- **说明2：从CPU角度，同一时刻只有一个虚拟地址空间**
	任意一个时刻，在一个CPU上只有一个进程在运行。当进程发生切换时，虚拟地址空间也会随之切换（通过将进程页表的pgd物理地址写入cr3控制寄存器）

- **说明3：最终在物理地址空间运行**
	**程序经编译链接后形成的地址空间**是虚拟地址空间，最终需要转换为物理地址并加载到物理内存中才能运行，这个映射关系需要通过页表完成
	如果给出的页表不同，CPU将某一虚拟地址空间中的地址转换成的物理地址就会不同。所以我们为每个进程都建立页表，将每个进程的虚拟地址空间根据自己的需要映射到物理地址空间



<!--stackedit_data:
eyJoaXN0b3J5IjpbMjAxNjk3NTcyMF19
-->